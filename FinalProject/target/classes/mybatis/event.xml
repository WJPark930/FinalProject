<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="event.model.Event">
	<insert id="eventInsert">
		insert into event values 
		(event_seq.nextval, #{ event_title }, #{ event_context }, #{ event_image,jdbcType=VARCHAR }, sysdate, #{ event_end_date }, #{ event_discount_kind }, #{ event_discount_amount } )
	</insert>
	
	<select id = "eventList" resultType = "MyEvent">
		select * from event order by event_num desc
	</select>
	
	<select id = "eventDetail" resultType = "MyEvent">
		select * from event where event_num = #{ event_num }
	</select>
	
	<delete id = "eventDelete">
		delete from event where event_num = #{ event_num }
	</delete>
	
	<update id = "eventUpdate">
		update event set 
		event_title = #{ event_title }, event_context = #{ event_context }, event_image = #{ event_image,jdbcType=VARCHAR }, event_end_date = #{ event_end_date }, event_discount_kind = #{ event_discount_kind }, event_discount_amount = #{ event_discount_amount } where event_num = #{ event_num }
	</update>
	
	<insert id="getThisCoupon">
		insert into coupon values (coupon_seq.nextval, #{ event_num }, #{ user_id }, #{ kind }, #{ amount }, default)
	</insert>
	
	<select id="showAllMyCoupon" resultType="MyCoupon">
		select * from coupon where user_id = #{ user_id }
	</select>
	
	<select id="showCanUseCoupon" resultType="MyCoupon">
		select * from coupon where user_id = #{ user_id } and use_status = 0
	</select>
	
	<select id="didIGetCoupon" resultType="MyCoupon">
		select * from coupon where user_id = #{ user_id } and event_num = #{ event_num }
	</select>
	
	<update id = "updateCouponUse_status">
		update coupon set use_status = 1 where user_id = #{ user_id } and coupon_num = #{ coupon_num }
	</update>
</mapper>

<!-- event.xml -->

